# -*- coding: utf-8 -*-
"""afterFE.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1jseNbMpXFDzCsbVKMhDfym1wpbqTwTWS
"""

# Importing libraries for Data Manipulation
import pandas as pd
import numpy as np

# Importing libraries for Visualization
import matplotlib.pyplot as plt
import seaborn as sns

# Importing libraries for Machine Learning
from sklearn.model_selection import train_test_split
from sklearn.preprocessing import StandardScaler
from sklearn.ensemble import RandomForestClassifier
from sklearn.metrics import accuracy_score, confusion_matrix, classification_report

# Importing libraries for Deep Learning
import torch
import torch.nn as nn
import torch.optim as optim

from google.colab import drive
drive.mount('/content/drive')

file_path = '/content/drive/My Drive/Colab_Notebooks/NAS.csv'

df = pd.read_csv(file_path)

df.dtypes

df.head()

df['Date'] = pd.to_datetime(df['Date'])

# ---- Time-Based Features ----
df['Day_of_Week'] = df['Date'].dt.dayofweek  # Monday=0, Sunday=6
df['Month'] = df['Date'].dt.month
df['Quarter'] = df['Date'].dt.quarter

# ---- Rolling Averages ----
df['Rolling_Mean_5'] = df['Close'].rolling(window=5).mean()
df['Rolling_Mean_10'] = df['Close'].rolling(window=10).mean()

# ---- Lagged Features ----
df['Close_Lag_1'] = df['Close'].shift(1)
df['Close_Lag_5'] = df['Close'].shift(5)

# ---- Interaction Features ----
df['Volume_Close_Interaction'] = df['Volume'] * df['Close'].pct_change()

df.head()

print(f"Row count before feature engineering: {df.shape[0]}")

df = df.dropna()

print(f"Row count after feature engineering: {df.shape[0]}")

df.head()

import pandas as pd

# Save the cleaned dataset
df.to_csv("cleaned_dataset.csv", index=False)

# Download the file
from google.colab import files
files.download("cleaned_dataset.csv")